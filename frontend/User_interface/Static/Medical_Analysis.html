<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Medical Sentiment Analysis & NER Dashboard</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <!-- Inline CSS -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #f6f8fb;
      color: #333;
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark-mode { background: #121212; color: #eee; }
    .app { display: flex; height: 100vh; overflow: hidden; }
    .sidebar {
      width: 220px;
      background-color: #004d40;
      color: #fff;
      display: flex;
      flex-direction: column;
      padding: 20px 0;
    }
    .sidebar h2 {
      text-align: center;
      font-weight: 700;
      margin-bottom: 30px;
      font-size: 20px;
      letter-spacing: 1.2px;
    }
    .nav-item {
      padding: 15px 30px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: background 0.3s;
      font-weight: 600;
      font-size: 15px;
    }
    .nav-item:hover, .nav-item.active { background-color: #00796b; }
    .header {
      height: 60px;
      background: #fff;
      border-bottom: 1px solid #e1e4eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.05);
    }
    body.dark-mode .header { background: #1f1f1f; border-color: #333; }
    .header .search { position: relative; width: 300px; }
    .header input[type="search"] {
      width: 100%;
      padding: 8px 36px 8px 12px;
      border-radius: 8px;
      border: 1.5px solid #ccc;
      font-size: 15px;
      transition: border-color 0.3s;
    }
    .header input[type="search"]:focus {
      outline: none;
      border-color: #00796b;
    }
    body.dark-mode .header input[type="search"] {
      background: #333;
      border-color: #555;
      color: #eee;
    }
    .header .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #888;
    }
    body.dark-mode .header .search-icon { color: #bbb; }
    .header .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 600;
      font-size: 15px;
      color: #555;
    }
    body.dark-mode .header .user-info { color: #ccc; }
    .header .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #00796b;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #fff;
      font-weight: 700;
      user-select: none;
    }
    .main-content {
      flex-grow: 1;
      overflow-y: auto;
      padding: 30px 40px;
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark-mode .main-content { background: #222; color: #eee; }
    .page-title {
      font-size: 28px;
      font-weight: 700;
      color: #004d40;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    body.dark-mode .page-title { color: #80cbc4; }
    .card {
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 6px 15px rgb(0 0 0 / 0.07);
      padding: 25px 30px;
      margin-bottom: 28px;
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark-mode .card { background: #333; color: #eee; }
    form label {
      font-weight: 600;
      font-size: 16px;
      color: #444;
      display: block;
      margin-bottom: 10px;
    }
    body.dark-mode form label { color: #ccc; }
    textarea, input[type="text"] {
      width: 100%;
      font-family: 'Courier New', monospace;
      font-size: 15px;
      border-radius: 10px;
      border: 1.8px solid #ccc;
      padding: 14px 18px;
      resize: vertical;
      transition: border-color 0.3s, background-color 0.3s, color 0.3s;
    }
    textarea { height: 110px; }
    body.dark-mode textarea, body.dark-mode input[type="text"] {
      background: #444;
      border-color: #666;
      color: #eee;
    }
    textarea:focus, input[type="text"]:focus {
      outline: none;
      border-color: #00796b;
      box-shadow: 0 0 8px #70b8a7;
    }
    button {
      margin-top: 18px;
      background-color: #00796b;
      color: white;
      border: none;
      padding: 14px 32px;
      font-weight: 700;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    button:hover { background-color: #004d40; }
    h3 {
      font-weight: 700;
      font-size: 20px;
      color: #004d40;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    body.dark-mode h3 { color: #80cbc4; }
    .result-text {
      background: #f7f9f9;
      padding: 14px 20px;
      border-left: 4px solid #00796b;
      border-radius: 6px;
      font-size: 16px;
      line-height: 1.5;
      white-space: pre-wrap;
      color: #333;
    }
    body.dark-mode .result-text { background: #555; color: #ddd; }
    .sentiment p, .confidence p { font-size: 16px; margin: 8px 0; }
    ul.ner-list {
      list-style-type: disc;
      padding-left: 22px;
      color: #444;
    }
    body.dark-mode ul.ner-list { color: #ccc; }
    ul.ner-list li { margin-bottom: 6px; font-size: 15px; }
    .main-content::-webkit-scrollbar { width: 8px; }
    .main-content::-webkit-scrollbar-thumb {
      background-color: #00796b;
      border-radius: 4px;
    }
    .hidden { display: none; }
    .settings-group { margin-bottom: 22px; }
    .settings-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .settings-toggle {
      display: flex;
      align-items: center;
      gap: 12px;
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <h2>MedAI</h2>
      <div class="nav-item active" id="navDashboard">üè• Dashboard</div>
      <div class="nav-item" id="navReports">üìä Reports</div>
      <div class="nav-item" id="navSettings">‚öôÔ∏è Settings</div>
    </aside>
    <div style="flex-grow:1; display:flex; flex-direction:column;">
      <header class="header">
        <div class="user-info">
          <div class="user-avatar" id="userAvatar">S</div>
          <div id="usernameDisplay">Shvansh Bajpai</div>
        </div>
      </header>
      <main class="main-content" id="mainContent">
        <!-- Dashboard content -->
        <div id="dashboardSection">
          <h1 class="page-title">üß† Medical Sentiment Analysis & NER</h1>
          <section class="card">
            <form id="analysisForm">
              <label for="medicalText">Enter your medical claim:</label>
              <textarea id="medicalText" required>I purchased Paracetamol from HealthPlus Pharmacy yesterday. The staff was very cooperative and explained the dosage clearly. I felt better within a day</textarea>
              <button type="submit">Analyze Medical Claim</button>
            </form>
          </section>
          <section class="card">
            <h3>üîç Analyzed Medical Claim</h3>
            <div id="textContent" class="result-text">[Analyzed text will appear here]</div>
          </section>
          <section class="card sentiment">
            <h3>üìä Sentiment Analysis</h3>
            <p id="sentiment">Sentiment: [N/A]</p>
            <p id="confidence">Confidence: [N/A]</p>
          </section>
          <section class="card ner">
            <h3>üß¨ Named Entity Recognition (NER)</h3>
            <ul id="nerList" class="ner-list">
              <li>[Entity List]</li>
            </ul>
          </section>
        </div>
        <!-- Reports content -->
        <div id="reportsSection" class="hidden">
          <h1 class="page-title">üìë Reports</h1>
          <section class="card">
            <p>Generate a PDF report of your medical claims analysis.</p>
            <button id="generatePdfBtn">Generate PDF Report</button>
          </section>
        </div>
        <!-- Settings content -->
        <div id="settingsSection" class="hidden">
          <h1 class="page-title">‚öôÔ∏è Settings</h1>
          <section class="card">
            <div class="settings-group">
              <label for="usernameInput">Change Username:</label>
              <input type="text" id="usernameInput" placeholder="Enter new username" />
            </div>
            <div class="settings-group settings-toggle">
              <label for="darkModeToggle">Dark Mode:</label>
              <input type="checkbox" id="darkModeToggle" />
            </div>
            <button id="saveSettingsBtn">Save Settings</button>
            <p id="settingsMessage" style="margin-top:12px; color:green; font-weight:bold;"></p>
          </section>
        </div>
      </main>
    </div>
  </div>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Inline JS -->
  <script>
    // Navigation toggle
    const navDashboard = document.getElementById('navDashboard');
    const navReports = document.getElementById('navReports');
    const navSettings = document.getElementById('navSettings');
    const dashboardSection = document.getElementById('dashboardSection');
    const reportsSection = document.getElementById('reportsSection');
    const settingsSection = document.getElementById('settingsSection');
    navDashboard.addEventListener('click', () => {
      navDashboard.classList.add('active');
      navReports.classList.remove('active');
      navSettings.classList.remove('active');
      dashboardSection.classList.remove('hidden');
      reportsSection.classList.add('hidden');
      settingsSection.classList.add('hidden');
    });
    navReports.addEventListener('click', () => {
      navReports.classList.add('active');
      navDashboard.classList.remove('active');
      navSettings.classList.remove('active');
      dashboardSection.classList.add('hidden');
      reportsSection.classList.remove('hidden');
      settingsSection.classList.add('hidden');
    });
    navSettings.addEventListener('click', () => {
      navSettings.classList.add('active');
      navDashboard.classList.remove('active');
      navReports.classList.remove('active');
      dashboardSection.classList.add('hidden');
      reportsSection.classList.add('hidden');
      settingsSection.classList.remove('hidden');
    });

    // Form and data for demonstration
    const form = document.getElementById('analysisForm');
    const textContent = document.getElementById('textContent');
    const sentimentEl = document.getElementById('sentiment');
    const confidenceEl = document.getElementById('confidence');
    const nerList = document.getElementById('nerList');

    form.addEventListener('submit', async e => {
      e.preventDefault();
      const text = document.getElementById('medicalText').value;

      // Call your backend API here
      try {
        const response = await fetch('http://127.0.0.1:5000/Predict_Sentiment', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ Medical_Claim: text })
        });
        const data = await response.json();

        textContent.textContent = data.Sentiment_Text || text;
        sentimentEl.textContent = `Sentiment: ${data.Sentiment_Prediction ?? '[N/A]'}`;
        confidenceEl.textContent = `Confidence: ${data.Sentiment_Score !== undefined ? Number(data.Sentiment_Score).toFixed(2) : '[N/A]'}`;
        nerList.innerHTML = '';
        if (Array.isArray(data.NER_Results) && data.NER_Results.length) {
          data.NER_Results.forEach(entity => {
            const li = document.createElement('li');
            li.textContent = `${entity.label}: ${entity.text}`;
            nerList.appendChild(li);
          });
        } else {
          const li = document.createElement('li');
          li.textContent = '[Entity List]';
          nerList.appendChild(li);
        }
      } catch (err) {
        textContent.textContent = '[Error analyzing claim]';
        sentimentEl.textContent = 'Sentiment: [N/A]';
        confidenceEl.textContent = 'Confidence: [N/A]';
        nerList.innerHTML = '<li>[Entity List]</li>';
      }
    });

    // PDF Generation
    const { jsPDF } = window.jspdf;
    const generatePdfBtn = document.getElementById('generatePdfBtn');
    generatePdfBtn.addEventListener('click', () => {
      const doc = new jsPDF();
      doc.setFontSize(20);
      doc.text("Medical Sentiment Analysis Report", 20, 20);
      doc.setFontSize(14);
      doc.text("Analyzed Medical Claim:", 20, 40);
      doc.setFontSize(12);
      doc.text(textContent.textContent || 'No data', 20, 50, { maxWidth: 170 });
      doc.setFontSize(14);
      doc.text("Sentiment Analysis:", 20, 80);
      doc.setFontSize(12);
      doc.text(sentimentEl.textContent || 'No data', 20, 90);
      doc.text(confidenceEl.textContent || 'No data', 20, 100);
      doc.setFontSize(14);
      doc.text("Named Entity Recognition (NER):", 20, 120);
      doc.setFontSize(12);
      const nerItems = Array.from(nerList.querySelectorAll('li')).map(li => li.textContent);
      let y = 130;
      if (nerItems.length) {
        nerItems.forEach(item => {
          if (y > 270) { doc.addPage(); y = 20; }
          doc.text(`- ${item}`, 20, y);
          y += 10;
        });
      } else {
        doc.text('No data', 20, y);
      }
      doc.save('medical_analysis_report.pdf');
    });

    // Settings handlers
    const usernameInput = document.getElementById('usernameInput');
    const darkModeToggle = document.getElementById('darkModeToggle');
    const saveSettingsBtn = document.getElementById('saveSettingsBtn');
    const settingsMessage = document.getElementById('settingsMessage');
    const userAvatar = document.getElementById('userAvatar');
    const usernameDisplay = document.getElementById('usernameDisplay');
    // Load saved settings from localStorage
    window.addEventListener('DOMContentLoaded', () => {
      const savedUsername = localStorage.getItem('username') || 'Shvansh Bajpai';
      const savedDarkMode = localStorage.getItem('darkMode') === 'true';
      usernameInput.value = savedUsername;
      usernameDisplay.textContent = savedUsername;
      userAvatar.textContent = savedUsername.charAt(0).toUpperCase();
      darkModeToggle.checked = savedDarkMode;
      if (savedDarkMode) {
        document.body.classList.add('dark-mode');
      }
    });
    saveSettingsBtn.addEventListener('click', () => {
      const newUsername = usernameInput.value.trim() || 'Shvansh Bajpai';
      const darkModeEnabled = darkModeToggle.checked;
      // Save to localStorage
      localStorage.setItem('username', newUsername);
      localStorage.setItem('darkMode', darkModeEnabled);
      // Update UI immediately
      usernameDisplay.textContent = newUsername;
      userAvatar.textContent = newUsername.charAt(0).toUpperCase();
      if (darkModeEnabled) {
        document.body.classList.add('dark-mode');
      } else {
        document.body.classList.remove('dark-mode');
      }
      settingsMessage.textContent = 'Settings saved successfully!';
      setTimeout(() => { settingsMessage.textContent = ''; }, 2000);
    });
  </script>
</body>
</html>
